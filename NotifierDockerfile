FROM node:18.16-alpine AS dependencies

WORKDIR /notifier
COPY notifier/package.json ./
RUN npm install


##
FROM node:18.16-alpine AS build

WORKDIR /notifier
COPY notifier ./
RUN apk add --update --no-cache openssl
RUN npm install

###
FROM node:18.16-alpine AS deploy

WORKDIR /notifier

ENV NODE_ENV production

COPY notifier ./

EXPOSE 3001

ENV PORT 3001

CMD ["node", "index.js"]
